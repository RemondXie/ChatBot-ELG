{"ast":null,"code":"import React,{useState}from'react';import'./chat.css';// Import styling for chat page\nimport axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chat=()=>{const[messages,setMessages]=useState([{text:\"Welcome! I'm here to assist you with any medical questions you might have. Please provide your name and age. Say GOODBYE if you want to quit.\",sender:\"bot\"}]);const[userInput,setUserInput]=useState(\"\");const handleSendMessage=async()=>{if(userInput.trim()){const newMessages=[...messages,{text:userInput,sender:\"user\"}];setMessages(newMessages);setUserInput(\"\");try{const response=await axios.post(\"http://localhost:4000/chat\",{messages:newMessages});const botResponse=response.data.botResponse;const content=botResponse.content;// GPT返回的文本\nlet parsedJson=null;try{// 尝试把 GPT 返回的文本解析为 JSON\nparsedJson=JSON.parse(content);}catch(e){// 如果解析失败，则 parsedJson 保持 null\nconsole.error(\"Error parsing GPT JSON:\",e);}if(parsedJson&&parsedJson.patient_overview!==undefined&&parsedJson.diagnosis!==undefined&&parsedJson.advice!==undefined){// GPT 给出了完整 JSON，分别插入三条消息，或者您也可以一次性拼在一起\nconst overviewMsg={text:\"Patient Overview: \"+parsedJson.patient_overview,sender:\"bot\"};const diagnosisMsg={text:\"Diagnosis: \"+parsedJson.diagnosis,sender:\"bot\"};const adviceMsg={text:\"Advice: \"+parsedJson.advice,sender:\"bot\"};setMessages(prev=>[...prev,overviewMsg,diagnosisMsg,adviceMsg]);}else{// 如果解析不成功 或 JSON 字段不全，则原样输出\nsetMessages(prev=>[...prev,{text:content,sender:\"bot\"}]);}}catch(error){console.error(\"Error calling backend API:\",error);setMessages(prevMessages=>[...prevMessages,{text:\"Sorry, an error occurred while processing your message.\",sender:\"bot\"}]);}}};// Handle the Enter key press\nconst handleKeyPress=e=>{if(e.key==='Enter'){handleSendMessage();}};// Reset chat\nconst handleResetChat=()=>{setMessages([{text:\"Welcome! I'm here to assist you with any medical questions you might have. Please provide your name and age. Say GOODBYE if you want to quit.\",sender:\"bot\"}]);// Reset to initial state\nsetUserInput(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"welcome-message\",children:\"Welcome! I'm here to assist you with any medical questions you might have.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-box\",children:messages.map((message,index)=>/*#__PURE__*/_jsxs(\"div\",{className:message.sender,children:[/*#__PURE__*/_jsx(\"strong\",{children:message.sender===\"user\"?\"Patient:\":\"Chatbot:\"}),/*#__PURE__*/_jsx(\"p\",{children:message.text})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:userInput,onChange:e=>setUserInput(e.target.value),onKeyDown:handleKeyPress// Add the key press event listener\n,placeholder:\"Type your message...\"}),/*#__PURE__*/_jsx(\"button\",{className:\"send-chat-button\",onClick:handleSendMessage,children:\"Send\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"reset-container\",children:/*#__PURE__*/_jsx(\"button\",{className:\"reset-chat-button\",onClick:handleResetChat,children:\"Reset Chat\"})})]});};export default Chat;","map":{"version":3,"names":["React","useState","axios","jsx","_jsx","jsxs","_jsxs","Chat","messages","setMessages","text","sender","userInput","setUserInput","handleSendMessage","trim","newMessages","response","post","botResponse","data","content","parsedJson","JSON","parse","e","console","error","patient_overview","undefined","diagnosis","advice","overviewMsg","diagnosisMsg","adviceMsg","prev","prevMessages","handleKeyPress","key","handleResetChat","className","children","map","message","index","type","value","onChange","target","onKeyDown","placeholder","onClick"],"sources":["D:/Medical chatbot/Medico-Assistance-OpenAI-ChatBot-Using-Python-main/textbase/textbase/Chatbot to send/src/chat.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport './chat.css';  // Import styling for chat page\r\nimport axios from \"axios\";\r\n\r\nconst Chat = () => {\r\n  const [messages, setMessages] = useState([\r\n    { text: \"Welcome! I'm here to assist you with any medical questions you might have. Please provide your name and age. Say GOODBYE if you want to quit.\", sender: \"bot\" },\r\n  ]);\r\n  const [userInput, setUserInput] = useState(\"\");\r\n\r\nconst handleSendMessage = async () => {\r\n  if (userInput.trim()) {\r\n    const newMessages = [...messages, { text: userInput, sender: \"user\" }];\r\n    setMessages(newMessages);\r\n    setUserInput(\"\");\r\n\r\n    try {\r\n      const response = await axios.post(\"http://localhost:4000/chat\", { messages: newMessages });\r\n      const botResponse = response.data.botResponse;\r\n      const content = botResponse.content;  // GPT返回的文本\r\n\r\n      let parsedJson = null;\r\n      try {\r\n        // 尝试把 GPT 返回的文本解析为 JSON\r\n        parsedJson = JSON.parse(content);\r\n      } catch (e) {\r\n        // 如果解析失败，则 parsedJson 保持 null\r\n        console.error(\"Error parsing GPT JSON:\", e);\r\n      }\r\n\r\n      if (\r\n        parsedJson &&\r\n        parsedJson.patient_overview !== undefined &&\r\n        parsedJson.diagnosis !== undefined &&\r\n        parsedJson.advice !== undefined\r\n      ) {\r\n        // GPT 给出了完整 JSON，分别插入三条消息，或者您也可以一次性拼在一起\r\n        const overviewMsg = { text: \"Patient Overview: \" + parsedJson.patient_overview, sender: \"bot\" };\r\n        const diagnosisMsg = { text: \"Diagnosis: \" + parsedJson.diagnosis, sender: \"bot\" };\r\n        const adviceMsg = { text: \"Advice: \" + parsedJson.advice, sender: \"bot\" };\r\n\r\n        setMessages((prev) => [...prev, overviewMsg, diagnosisMsg, adviceMsg]);\r\n      } else {\r\n        // 如果解析不成功 或 JSON 字段不全，则原样输出\r\n        setMessages((prev) => [...prev, { text: content, sender: \"bot\" }]);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error(\"Error calling backend API:\", error);\r\n      setMessages((prevMessages) => [\r\n        ...prevMessages,\r\n        { text: \"Sorry, an error occurred while processing your message.\", sender: \"bot\" },\r\n      ]);\r\n    }\r\n  }\r\n};\r\n\r\n  // Handle the Enter key press\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter') {\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  // Reset chat\r\n  const handleResetChat = () => {\r\n    setMessages([{ text: \"Welcome! I'm here to assist you with any medical questions you might have. Please provide your name and age. Say GOODBYE if you want to quit.\", sender: \"bot\" }]); // Reset to initial state\r\n    setUserInput(\"\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat\">\r\n      {/* Displaying the welcome message with a larger font */}\r\n      <div className=\"welcome-message\">\r\n        Welcome! I'm here to assist you with any medical questions you might have.\r\n      </div>\r\n\r\n      <div className=\"chat-box\">\r\n        {messages.map((message, index) => (\r\n          <div key={index} className={message.sender}>\r\n            <strong>{message.sender === \"user\" ? \"Patient:\" : \"Chatbot:\"}</strong>\r\n            <p>{message.text}</p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"input-container\">\r\n        <input\r\n          type=\"text\"\r\n          value={userInput}\r\n          onChange={(e) => setUserInput(e.target.value)}\r\n          onKeyDown={handleKeyPress}  // Add the key press event listener\r\n          placeholder=\"Type your message...\"\r\n        />\r\n        <button className=\"send-chat-button\" onClick={handleSendMessage}>Send</button>\r\n      </div>\r\n\r\n      {/* Reset Button outside the input container */}\r\n      <div className=\"reset-container\">\r\n        <button className=\"reset-chat-button\" onClick={handleResetChat}>Reset Chat</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}